# Codecov Configuration for Kalshi Market Insights
# https://docs.codecov.com/docs/codecovyml-reference

codecov:
  branch: main # Default branch for coverage comparison
  max_report_age: '12h' # Reports older than 12 hours are considered stale

# Coverage targets and thresholds
coverage:
  status:
    project:
      default:
        target: 70%
        threshold: 1%
    patch:
      default:
        target: 80%
        threshold: 5%

# Pull Request Comment Configuration
comment:
  layout: 'reach,diff,flags,tree,sunburst'
  behavior: default
  require_changes: false

# Flags for separating backend/frontend coverage
flags:
  backend:
    paths:
      - backend/
    carryforward: true

  frontend:
    paths:
      - frontend/
    carryforward: true

# Component tracking for critical areas
component_management:
  individual_components:
    # Phase 2: WebSocket Infrastructure (High Priority)
    - component_id: "websocket_infra"
      name: "WebSocket Infrastructure"
      paths:
        - backend/infrastructure/kalshi/websocket_client.py
        - backend/infrastructure/polling/gap_filler.py

    # API Layer
    - component_id: "api"
      name: "API Layer"
      paths:
        - backend/api/**

    # Domain Logic (Business Rules)
    - component_id: "domain"
      name: "Domain Logic"
      paths:
        - backend/domain/**

    # Kalshi Integration
    - component_id: "kalshi_integration"
      name: "Kalshi Integration"
      paths:
        - backend/infrastructure/kalshi/**

    # Data Access Layer
    - component_id: "repositories"
      name: "Repositories"
      paths:
        - backend/domain/repositories/**

    # Frontend Components
    - component_id: "ui_components"
      name: "UI Components"
      paths:
        - frontend/src/components/**

# GitHub Checks configuration
github_checks:
  annotations: true

# Ignore patterns
ignore:
  # Test files
  - '**/*.test.py'
  - '**/*.test.ts'
  - '**/*.test.tsx'
  - '**/test/**/*'
  - '**/tests/**/*'
  - '**/__tests__/**/*'

  # Build artifacts and dependencies
  - '**/__pycache__/**'
  - '**/node_modules/**'
  - '**/.venv/**'
  - '**/venv/**'
  - '**/dist/**'
  - '**/build/**'
  - '**/.pytest_cache/**'
  - '**/htmlcov/**'
  - '**/coverage/**'

  # Configuration files
  - '**/*.config.js'
  - '**/*.config.ts'
  - '**/vite.config.ts'
  - '**/vitest.config.ts'

  # Documentation
  - '**/*.md'
  - 'docs/**'
  - 'claudedocs/**'
